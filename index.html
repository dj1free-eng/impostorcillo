<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>El Impostorcillo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at top, #1f2937 0, #020617 45%, #000 100%);
      color: #f5f5f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .app {
      width: 100%;
      max-width: 480px;
      padding: 16px;
    }

    .card {
      background: rgba(15, 23, 42, 0.95);
      border-radius: 20px;
      padding: 24px 20px 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.6);
      position: relative;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(148, 163, 184, 0.3);
    }

    h1, h2, h3 {
      margin-top: 0;
      text-align: center;
    }

    h1 {
      font-size: 1.9rem;
      margin-bottom: 0.5rem;
    }

    p {
      line-height: 1.4;
    }

    label {
      display: block;
      margin: 10px 0 4px;
      font-size: 0.9rem;
      opacity: 0.9;
    }

    input, select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
      margin-bottom: 8px;
    }

    /* Botones normales del juego */
    button {
      width: 100%;
      padding: 12px;
      border-radius: 999px;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      margin-top: 14px;
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #fff;
      box-shadow: 0 6px 16px rgba(22, 163, 74, 0.5);
      transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.15s ease;
    }

    button.secondary {
      background: #374151;
      box-shadow: none;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: 0 3px 8px rgba(22, 163, 74, 0.4);
      opacity: 0.9;
    }
    /* Bot√≥n "Jugador siguiente" (estado por defecto: apagado) */
    #nextPlayerBtn {
      background: #3f3f46;          /* gris apagado */
      color: #d4d4d8;
      opacity: 0.5;
      border-radius: 12px;
      padding: 14px 24px;
      font-size: 1.05rem;
      border: none;
      width: 90%;
      max-width: 320px;
      margin: 20px auto 0;
      display: block;
      box-shadow: none;
    }

    /* Estado ACTIVADO: cuando el jugador ya ha visto su rol */
    #nextPlayerBtn.active {
      background: linear-gradient(135deg, #16a34a, #22c55e);
      color: #ffffff;
      opacity: 1;
      box-shadow: 0 0 12px rgba(34,197,94,0.6);
    }
    .small {
      font-size: 0.85rem;
      text-align: center;
      opacity: 0.8;
      margin-top: 12px;
    }

    .hidden {
      display: none;
    }

    .badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      background: #1f2937;
      color: #9ca3af;
      margin-bottom: 10px;
    }

    .center {
      text-align: center;
    }

    .highlight {
      color: #22c55e;
      font-weight: 700;
    }

    /* Bot√≥n peque√±o de men√∫ */
    .menu-button {
      position: absolute;
      top: -14px;
      right: -14px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      background: #374151;
      color: #e5e7eb;
      font-size: 0.7rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px !important;
      z-index: 10;
    }

    .menu-button span {
      pointer-events: none;
    }

    .menu-button:hover {
      opacity: 1;
    }

    /* Pantalla inicio: hero */
    .hero-illustration {
      display: flex;
      justify-content: center;
      margin-bottom: 16px;
    }

    .hero-illustration img {
      width: 80%;
      max-width: 260px;
      border-radius: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }

    /* Cabecera configuraci√≥n con icono */
    .title-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 4px;
    }

    .title-icon {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }

    /* Carta deslizable para rol */
.role-badge-row .badge {
  background: rgba(15,23,42,0.95);
  color: #e5e7eb;
  border-radius: 999px;
  padding: 6px 14px;
  letter-spacing: 0.08em;
  font-weight: 600;
  font-size: 0.75rem;
}

.card-slider {
  width: 100%;
  height: 340px;
  background: radial-gradient(circle at top, #1f2937 0, #020617 60%, #000 100%);
  border-radius: 24px;
  overflow: hidden;
  position: relative;
  touch-action: none;
  box-shadow: 0 12px 30px rgba(0,0,0,0.7);
  margin-bottom: 18px;
  border: 1px solid rgba(148,163,184,0.4);
}

  .card-back,
.card-front {
  position: absolute;
  inset: 10px;                 /* üëà margen dentro del marco oscuro */
  border-radius: 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.35);
}

/* Parte trasera (rol) */
.card-back {
  background: #f9fafb;
  padding: 24px 16px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
}

/* Parte frontal (imagen + texto deslizar) */
.card-front {
  background: linear-gradient(to bottom, #facc15 0%, #fff 55%);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  touch-action: none;
}

.card-front-img {
  width: 100%;
  height: 68%;
  object-fit: contain;
  border-radius: 18px 18px 0 0;
}

.slide-text {
  text-align: center;
  font-size: 1rem;
  margin: 8px 0 14px;
  color: #1f2933;
  font-weight: 500;
}

#roleTitle {
  font-size: 1.6rem;
  margin-bottom: 8px;
  color: #111827;
}

#roleWord {
  font-size: 1.9rem;
  font-weight: 800;
  color: #111827;
  margin-bottom: 10px;
}

.role-tip {
  font-size: 0.95rem;
  color: #4b5563;
  max-width: 260px;
}
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <!-- Bot√≥n men√∫ global -->
      <button class="menu-button" onclick="goToSetup()">
        <span>‚â°</span>
      </button>

      <!-- Pantalla: Inicio -->
      <div id="screen-start">
        <div class="hero-illustration">
          <img src="img/impostor-hero.png" alt="Impostorcillo">
        </div>
        <h1>El Impostorcillo</h1>
        <p class="center">
          El juego social de deducci√≥n y enga√±o.<br>
          ¬°Intenta no parecer sospechoso!
        </p>
        <button onclick="goToSetup()">Nueva partida</button>
      </div>

      <!-- Pantalla: Configuraci√≥n -->
      <div id="screen-setup" class="hidden">
        <div class="title-row">
          <img src="img/impostor-icon.png" class="title-icon" alt="">
          <h2>Configuraci√≥n</h2>
        </div>

        <label for="numPlayers">N√∫mero de jugadores</label>
        <select id="numPlayers">
          <option value="3" selected>3 jugadores</option>
          <option value="4">4 jugadores</option>
          <option value="5">5 jugadores</option>
          <option value="6">6 jugadores</option>
          <option value="7">7 jugadores</option>
          <option value="8">8 jugadores</option>
          <option value="9">9 jugadores</option>
          <option value="10">10 jugadores</option>
          <option value="11">11 jugadores</option>
          <option value="12">12 jugadores</option>
        </select>

        <label for="category">Categor√≠a</label>
        <select id="category">
          <option value="random">Aleatorio</option>
          <option value="comida">Comida</option>
          <option value="sitios">Lugares</option>
          <option value="peliculas">Pel√≠culas</option>
          <option value="objetos">Objetos</option>
        </select>

        <button onclick="startGame()">Empezar</button>
        <button class="secondary" onclick="backToStart()">Volver</button>

        <p class="small">
          Modo actual: 1 solo Impostorcillo, votos y acusaciones se hacen de viva voz.
        </p>
      </div>

      <!-- Pantalla: Rol del jugador (con carta deslizable) -->
      <div id="screen-role" class="hidden">
        <div class="role-badge-row">
          <span class="badge" id="playerBadge"></span>
        </div>

        <div class="card-slider">
  <!-- Parte trasera: el rol -->
  <div class="card-back">
    <h3 id="roleTitle"></h3>
    <div id="roleWord"></div>
    <p class="role-tip" id="roleTip"></p>
  </div>

  <!-- Parte frontal: la que se arrastra -->
  <div class="card-front" id="cardFront">
    <img src="img/group-players.png" class="card-front-img" alt="Jugadores">
    <p class="slide-text">Desliza hacia arriba para ver tu rol</p>
  </div>
</div>

        <p class="small">
  Mant√©n el dedo mientras lees tu rol.<br>
  Al soltar, la carta baja y lo tapa de nuevo.
</p>

<button id="nextPlayerBtn" class="secondary hidden" onclick="nextPlayer()">
  Jugador siguiente
</button>
      </div>

      <!-- Pantalla: Debate / votaci√≥n -->
      <div id="screen-vote" class="hidden">
        <h2>Debatid y votad</h2>
        <p class="center">
          Todos hab√©is visto ya vuestro rol.<br/><br/>
          Ahora:
        </p>
        <ul style="font-size:0.95rem; line-height:1.5;">
          <li>Dad una pista cada uno, sin decir la palabra.</li>
          <li>Comentad y acusad a quien cre√°is que es el Impostorcillo.</li>
          <li>Haced una votaci√≥n final.</li>
        </ul>
        <p class="small">
          Cuando teng√°is decidido qui√©n es el Impostorcillo,<br/>
          pulsad el bot√≥n de abajo para ver el resultado real.
        </p>
        <button onclick="revealRoles()">Revelar resultado</button>
      </div>

      <!-- Pantalla: Revelaci√≥n final -->
      <div id="screen-reveal" class="hidden">
        <h2>Revelaci√≥n</h2>
        <p class="center">La palabra secreta era:</p>
        <div style="font-size:1.9rem; text-align:center; margin: 12px 0;" id="finalWord"></div>
        <p class="center">
          El Impostorcillo era el <span class="highlight" id="impostorPlayer"></span>.
        </p>
        <p class="small">
          ¬øHab√©is acertado? ¬øO el Impostorcillo os ha liado a todos? üòà
        </p>
        <button onclick="goToSetup()">Jugar otra vez</button>
        <button class="secondary" onclick="backToStart()">Salir al inicio</button>
      </div>
    </div>
  </div>

<script>
/* ============================================================
   BASE DE DATOS DE PALABRAS (PACKS)
============================================================ */

const categories = {
  comida: [
    "Pizza","Pasta","Hamburguesa","Tortilla","Croquetas",
    "Helado","Galletas","Ensalada","Paella","Queso"
  ],
  animales: [
    "Perro","Gato","Elefante","Tigre","Mono",
    "Pez","Tortuga","Caballo","Le√≥n","Delf√≠n"
  ],
  objetos: [
    "Mesa","Silla","Cuchillo","Tel√©fono","Llaves",
    "Reloj","Gafas","L√°mpara","C√°mara","Mochila"
  ]
};

let usedWords = {
  comida: [],
  animales: [],
  objetos: []
};

/* ============================================================
   ESTADO GLOBAL DEL JUEGO
============================================================ */

const gameState = {
  screen: "start",
  numPlayers: 3,
  currentPlayer: 1,
  selectedCategory: "aleatorio",
  word: "",
  impostorIndex: 1,
  roleShown: false
};

/* ============================================================
   CAMBIO DE PANTALLAS
============================================================ */

function showScreen(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  gameState.screen = id;
}

/* ============================================================
   BOT√ìN ‚ÄúINICIAR PARTIDA‚Äù
============================================================ */

function goToSetup() {
  showScreen("screen-setup");
}

function startGame() {
  const numSel = document.getElementById("selectPlayers");
  const catSel = document.getElementById("selectCategory");

  gameState.numPlayers = parseInt(numSel.value);
  gameState.selectedCategory = catSel.value;

  prepareNewRound();
  showScreen("screen-role");

  prepareCurrentPlayerScreen();
}

/* ============================================================
   SELECCI√ìN DE PALABRAS + IMPOSTOR
============================================================ */

function pickWord(category) {
  let pack = categories[category];

  // Evitar repetidas
  let remaining = pack.filter(w => !usedWords[category].includes(w));

  if (remaining.length === 0) {
    alert("Se han agotado las palabras de esta categor√≠a.\nSe reinicia el pack.");
    usedWords[category] = [];
    remaining = pack;
  }

  const word = remaining[Math.floor(Math.random() * remaining.length)];
  usedWords[category].push(word);

  return word;
}

function prepareNewRound() {
  // Elegir categor√≠a
  const cats = Object.keys(categories);
  const chosen =
    gameState.selectedCategory === "aleatorio"
      ? cats[Math.floor(Math.random() * cats.length)]
      : gameState.selectedCategory;

  gameState.word = pickWord(chosen);

  // Elegir impostor
  gameState.impostorIndex =
    Math.floor(Math.random() * gameState.numPlayers) + 1;

  gameState.currentPlayer = 1;
}

/* ============================================================
   MOSTRAR ROL DEL JUGADOR ACTUAL
============================================================ */

function prepareCurrentPlayerScreen() {
  const badge = document.getElementById("playerBadge");
  const roleTitle = document.getElementById("roleTitle");
  const roleWord = document.getElementById("roleWord");
  const roleTip = document.getElementById("roleTip");
  const nextBtn = document.getElementById("nextPlayerBtn");

  badge.textContent = `JUGADOR ${gameState.currentPlayer} DE ${gameState.numPlayers}`;

  const isImpostor = gameState.currentPlayer === gameState.impostorIndex;

  if (isImpostor) {
    roleTitle.textContent = "Impostorcillo";
    roleWord.textContent = "???";
    roleTip.textContent =
      "No conoces la palabra secreta. Escucha las pistas de los dem√°s y finge que t√∫ tambi√©n la sabes.";
  } else {
    roleTitle.textContent = "Ciudadano";
    roleWord.textContent = `"${gameState.word}"`;
    roleTip.textContent =
      "Conoces la palabra secreta. Da pistas sin decirla directamente.";
  }

  // Reset del bot√≥n
  nextBtn.classList.add("hidden");
  nextBtn.classList.remove("active");
  gameState.roleShown = false;

  // Reset de la carta
  document.getElementById("cardFront").style.transform = "translateY(0)";
}

/* ============================================================
   PASAR AL SIGUIENTE JUGADOR
============================================================ */

function nextPlayer() {
  const nextBtn = document.getElementById("nextPlayerBtn");
  nextBtn.classList.remove("active");
  nextBtn.classList.add("hidden");

  gameState.currentPlayer++;

  if (gameState.currentPlayer > gameState.numPlayers) {
    showScreen("screen-start");
    return;
  }

  prepareCurrentPlayerScreen();
}

/* ============================================================
   DESLIZAMIENTO PRIVADO DE LA CARTA (ROL)
============================================================ */

const cardFrontEl = document.getElementById("cardFront");
const nextBtnEl   = document.getElementById("nextPlayerBtn");

let dragStartY = 0;
let dragging = false;
let cardHeight = 0;

function onTouchStart(e) {
  const slider = cardFrontEl.parentElement;
  cardHeight = slider.offsetHeight;

  dragStartY = e.touches[0].clientY;
  dragging = true;

  cardFrontEl.style.transition = "none";
}

function onTouchMove(e) {
  if (!dragging) return;

  const currentY = e.touches[0].clientY;
  let delta = currentY - dragStartY;

  if (delta > 0) delta = 0;
  if (delta < -cardHeight) delta = -cardHeight;

  cardFrontEl.style.transform = `translateY(${delta}px)`;

  // Activamos bot√≥n si ha visto el rol
  if (delta < -cardHeight / 3 && !gameState.roleShown) {
    gameState.roleShown = true;
    nextBtnEl.classList.remove("hidden");
    nextBtnEl.classList.add("active"); // <<< bot√≥n se enciende
  }
}

function onTouchEnd() {
  dragging = false;

  cardFrontEl.style.transition = "transform 0.25s ease";
  cardFrontEl.style.transform = "translateY(0)";

  setTimeout(() => {
    cardFrontEl.style.transition = "";
  }, 250);
}

cardFrontEl.addEventListener("touchstart", onTouchStart, { passive: true });
cardFrontEl.addEventListener("touchmove", onTouchMove, { passive: true });
cardFrontEl.addEventListener("touchend", onTouchEnd);

</script>
</body>
</html>
